
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Repositorio personal de aprendizajes sobre Data, Desarrollo, DevOps y Tecnología">
      
      
        <meta name="author" content="Erick Sang">
      
      
        <link rel="canonical" href="https://leonsang.github.io/spark-notebooks/notes/">
      
      
        <link rel="prev" href="../24_Skewness_And_Salting/">
      
      
        <link rel="next" href="../../advanced-notebooks/Auto%20Loader%20%20Normal%20Schema%20Evolution/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Mis Notas - Base de Conocimiento - Erick Sang</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spark-concepts-and-code" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="Base de Conocimiento - Erick Sang" class="md-header__button md-logo" aria-label="Base de Conocimiento - Erick Sang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Base de Conocimiento - Erick Sang
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mis Notas
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Compartir" aria-label="Compartir" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/leonsang/leonsang" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    leonsang/leonsang
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Inicio

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data-engineering/" class="md-tabs__link">
          
  
  
  Data Engineering

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../python/" class="md-tabs__link">
          
  
  
  Data Analysis

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../python/" class="md-tabs__link">
          
  
  
  Programación

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../cloud/" class="md-tabs__link">
          
  
  
  DevOps & Cloud

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../notebooks/" class="md-tabs__link">
          
  
  
  Spark Notebooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../advanced-notebooks/Auto%20Loader%20%20Normal%20Schema%20Evolution/" class="md-tabs__link">
          
  
  
  Notebooks Avanzados

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Base de Conocimiento - Erick Sang" class="md-nav__button md-logo" aria-label="Base de Conocimiento - Erick Sang" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3C7.58 3 4 4.79 4 7s3.58 4 8 4 8-1.79 8-4-3.58-4-8-4M4 9v3c0 2.21 3.58 4 8 4s8-1.79 8-4V9c0 2.21-3.58 4-8 4s-8-1.79-8-4m0 5v3c0 2.21 3.58 4 8 4s8-1.79 8-4v-3c0 2.21-3.58 4-8 4s-8-1.79-8-4"/></svg>

    </a>
    Base de Conocimiento - Erick Sang
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/leonsang/leonsang" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    leonsang/leonsang
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Engineering
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Data Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data-engineering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fundamentos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apache Spark
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spark-internals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spark Internals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../databricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Databricks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../streaming-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Streaming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apache Kafka
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../kafka/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kafka Ecosystem
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../airflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Apache Airflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dbt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dbt
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data Analysis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SQL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BI & Analytics
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Programación
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Programación
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../others/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Best Practices
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DevOps & Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            DevOps & Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cloud/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Computing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../microsoft-fabric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Fabric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Google Cloud
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Google Cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gcp/gcs-shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud Shell
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gcp/gcp-bigquery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BigQuery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gcp/dataflow-streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Azure
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Azure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ADF_scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Factory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Spark Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Spark Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_Installing_Spark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Instalación
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02_TransformationsPtII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformaciones II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03_TransformationsPtIII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformaciones III
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_Strings_Dates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strings y Fechas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_Union_UnionAll_Aggregations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Union y Agregaciones
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_Window_Functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Window Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_Repartitioning_Coalesce_Joins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Joins y Particiones
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_ReadFormats_HandlingErronousRecords/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Formatos de Datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_ComplexFileFormats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Formatos Complejos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10_Working_With_Json_Data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trabajo con JSON
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11_Writing_Data_Spark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Escritura de Datos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12_Spark_UDFs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    UDFs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13_Spark_DAG_UI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DAG UI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14_OptimizingShuffles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimización Shuffles
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16_Cache_Persist_Techniques/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache y Persist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21_BroadCastVariables_Accumulators/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variables Broadcast
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22_Join_Optimizations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimización Joins I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22_Join_Optimizations_Pt2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimización Joins II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23_Dynamic_Static_Resource_Allocation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recursos Dinámicos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24_Skewness_And_Salting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Skewness y Salting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Mis Notas
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Mis Notas
    
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Contenido">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Contenido
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spark-concepts-and-code" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Concepts and Code
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Spark Concepts and Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lecture-1-what-is-apache-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 1 : What is Apache Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 1 : What is Apache Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unified" class="md-nav__link">
    <span class="md-ellipsis">
      Unified :
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computing-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Computing Engine:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Compute Cluster:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-2-why-apache-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 2 : Why Apache Spark?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 2 : Why Apache Spark?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-big-data" class="md-nav__link">
    <span class="md-ellipsis">
      What is Big Data?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issues-with-rdbms" class="md-nav__link">
    <span class="md-ellipsis">
      Issues with RDBMS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monolith-vs-microservice-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Monolith vs Microservice Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-3-hadoop-vs-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 3 : Hadoop vs Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 3 : Hadoop vs Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misconception" class="md-nav__link">
    <span class="md-ellipsis">
      Misconception:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differences" class="md-nav__link">
    <span class="md-ellipsis">
      Differences
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Differences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    <span class="md-ellipsis">
      Performance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#batch-vs-stream-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Batch vs Stream Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ease-of-use" class="md-nav__link">
    <span class="md-ellipsis">
      Ease of Use
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    <span class="md-ellipsis">
      Security
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fault-tolerance" class="md-nav__link">
    <span class="md-ellipsis">
      Fault Tolerance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-4-spark-ecosystem" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 4 : Spark Ecosystem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 4 : Spark Ecosystem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-does-spark-run" class="md-nav__link">
    <span class="md-ellipsis">
      Where does Spark run?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-5-read-modes-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 5 : Read Modes in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 5 : Read Modes in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataframereader-api" class="md-nav__link">
    <span class="md-ellipsis">
      DataframeReader API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mode-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      mode in Spark
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-6-spark-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 6 : Spark Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 6 : Spark Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spark-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      Spark Cluster
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-happens-when-user-submits-code" class="md-nav__link">
    <span class="md-ellipsis">
      What happens when user submits code?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-happens-inside-the-container" class="md-nav__link">
    <span class="md-ellipsis">
      What happens inside the container?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What happens inside the container?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#driver-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Driver Allocation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker-allocation" class="md-nav__link">
    <span class="md-ellipsis">
      Worker Allocation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executor-container" class="md-nav__link">
    <span class="md-ellipsis">
      Executor Container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-7-schema-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 7 : Schema in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 7 : Schema in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structtype-and-structfield" class="md-nav__link">
    <span class="md-ellipsis">
      StructType and StructField
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-8-handling-corrupter-records-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 8 : Handling Corrupter Records in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 8 : Handling Corrupter Records in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-many-records-in-each-mode" class="md-nav__link">
    <span class="md-ellipsis">
      How many records in each mode?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How many records in each mode?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#permissive-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Permissive Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dropmalformed" class="md-nav__link">
    <span class="md-ellipsis">
      DropMalformed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-print-corrupted-records" class="md-nav__link">
    <span class="md-ellipsis">
      How to Print Corrupted Records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-store-corrupted-records" class="md-nav__link">
    <span class="md-ellipsis">
      How to Store Corrupted Records
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-9-transformations-and-actions-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 9 : Transformations and Actions in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 9 : Transformations and Actions in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#types-of-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      Types of Transformations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-10-dag-and-lazy-evaluation-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 10 : DAG and Lazy Evaluation in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 10 : DAG and Lazy Evaluation in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimizations-on-the-filter" class="md-nav__link">
    <span class="md-ellipsis">
      Optimizations on the Filter
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-11-working-with-json-data-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 11: Working with JSON Data in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 11: Working with JSON Data in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#different-number-of-keys-in-each-line" class="md-nav__link">
    <span class="md-ellipsis">
      Different number of keys in each line
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiline-incorrect-json" class="md-nav__link">
    <span class="md-ellipsis">
      Multiline Incorrect JSON
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corrupted-records" class="md-nav__link">
    <span class="md-ellipsis">
      Corrupted Records
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-12-spark-sql-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 12: Spark SQL Engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 12: Spark SQL Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-is-spark-code-compiled" class="md-nav__link">
    <span class="md-ellipsis">
      How is Spark Code compiled?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phases-in-catalyst-optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      Phases in Catalyst Optimizer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phases in Catalyst Optimizer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workflow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Workflow Diagram
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-13-resilient-distributed-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 13: Resilient Distributed Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 13: Resilient Distributed Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-storage-of-list" class="md-nav__link">
    <span class="md-ellipsis">
      Data Storage of List
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-storage-in-rdd" class="md-nav__link">
    <span class="md-ellipsis">
      Data Storage in RDD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disadvantage-of-rdd" class="md-nav__link">
    <span class="md-ellipsis">
      Disadvantage of RDD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advantage" class="md-nav__link">
    <span class="md-ellipsis">
      Advantage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#avoiding-rdds" class="md-nav__link">
    <span class="md-ellipsis">
      Avoiding RDDs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-14-parquet-file-internals" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 14 : Parquet File Internals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 14 : Parquet File Internals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physical-storage-of-data-on-disk" class="md-nav__link">
    <span class="md-ellipsis">
      Physical Storage of Data on Disk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#write-once-read-many" class="md-nav__link">
    <span class="md-ellipsis">
      Write Once Read Many
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-columnar-format-may-not-be-the-best" class="md-nav__link">
    <span class="md-ellipsis">
      Why Columnar format may not be the best?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logical-partitioning-in-parquet" class="md-nav__link">
    <span class="md-ellipsis">
      Logical Partitioning in Parquet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runlength-encoding-and-bitpacking" class="md-nav__link">
    <span class="md-ellipsis">
      Runlength Encoding and Bitpacking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    <span class="md-ellipsis">
      Demo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bitpacking-advantage" class="md-nav__link">
    <span class="md-ellipsis">
      Bitpacking Advantage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#projection-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      Projection Pruning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-15-how-to-write-data-on-the-disk" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 15 : How to write data on the disk?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 15 : How to write data on the disk?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modes-to-write-data" class="md-nav__link">
    <span class="md-ellipsis">
      Modes to write data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-16-partitioning-and-bucketing" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 16: Partitioning and Bucketing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 16: Partitioning and Bucketing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-partitioning" class="md-nav__link">
    <span class="md-ellipsis">
      Example of Partitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitioning-by-address-and-gender" class="md-nav__link">
    <span class="md-ellipsis">
      Partitioning by Address and Gender
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bucketing-by-id" class="md-nav__link">
    <span class="md-ellipsis">
      Bucketing by Id
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tasks-vs-buckets" class="md-nav__link">
    <span class="md-ellipsis">
      Tasks vs Buckets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-does-bucketing-help-with-joins" class="md-nav__link">
    <span class="md-ellipsis">
      How does bucketing help with joins?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bucket-pruning" class="md-nav__link">
    <span class="md-ellipsis">
      Bucket Pruning
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-17-spark-session-vs-spark-context" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 17 : Spark Session vs Spark Context
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-18-job-stage-and-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 18: Job, Stage and Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 18: Job, Stage and Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-of-jobaction-and-task" class="md-nav__link">
    <span class="md-ellipsis">
      Example of Job,Action and Task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#complete-flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Complete flow diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-tasks-get-created-read-and-write-exchange" class="md-nav__link">
    <span class="md-ellipsis">
      How do tasks get created? [Read and Write Exchange]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-17-dataframe-transformations-in-spark-part-1" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 17: Dataframe Transformations in Spark Part 1
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 17: Dataframe Transformations in Spark Part 1">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ways-to-select-values-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Ways to select values / columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecutre-18-dataframe-transformations-in-spark-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      Lecutre 18 : Dataframe Transformations in Spark Part II
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecutre 18 : Dataframe Transformations in Spark Part II">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filter-where-no-difference" class="md-nav__link">
    <span class="md-ellipsis">
      filter() / where() no difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-filter-conditions" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple filter conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#literals-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Literals in spark
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Adding Columns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renaming-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Renaming Columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-19-union-vs-unionall" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 19: union vs unionAll()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19: union vs unionAll()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#selecting-data-and-unioning-the-same-table" class="md-nav__link">
    <span class="md-ellipsis">
      Selecting data and unioning the same table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-happens-when-we-change-the-order-of-the-columns" class="md-nav__link">
    <span class="md-ellipsis">
      What happens when we change the order of the columns?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-19-repartitioning-and-coalesce" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 19: Repartitioning and Coalesce
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 19: Repartitioning and Coalesce">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repartitioning-vs-coalesce" class="md-nav__link">
    <span class="md-ellipsis">
      Repartitioning vs Coalesce
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Repartitioning vs Coalesce">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repartitioning" class="md-nav__link">
    <span class="md-ellipsis">
      Repartitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coalesce" class="md-nav__link">
    <span class="md-ellipsis">
      Coalesce
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pros-and-cons-in-repartitioning" class="md-nav__link">
    <span class="md-ellipsis">
      Pros and Cons in repartitioning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-get-number-of-partitions" class="md-nav__link">
    <span class="md-ellipsis">
      How to get number of partitions?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coalescing" class="md-nav__link">
    <span class="md-ellipsis">
      Coalescing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-20-case-when-if-else-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 20 : Case when / if else in Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 20 : Case when / if else in Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apply-logic-on-one-column-then-process-if-else-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Apply logic on one column then process if else logic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#spark-sql-logic" class="md-nav__link">
    <span class="md-ellipsis">
      Spark SQL Logic
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-21-unique-and-sorted-records" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 21 : Unique and Sorted Records
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 21 : Unique and Sorted Records">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#distinct" class="md-nav__link">
    <span class="md-ellipsis">
      distinct()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dropping-duplicate-records" class="md-nav__link">
    <span class="md-ellipsis">
      Dropping duplicate records
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sort" class="md-nav__link">
    <span class="md-ellipsis">
      sort()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-22-aggregate-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 22 : Aggregate functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 22 : Aggregate functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#count-as-both-action-and-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Count as both Action and Transformation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lecture-23-group-by-in-spark" class="md-nav__link">
    <span class="md-ellipsis">
      Lecture 23: Group By In Spark
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lecture 23: Group By In Spark">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-do-we-use-window-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Where do we use window functions?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grouping-by-two-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Grouping by two columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks Avanzados
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Notebooks Avanzados
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/Auto%20Loader%20%20Normal%20Schema%20Evolution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Auto Loader Evolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/Auto%20Loader%20rescue%20mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Auto Loader Rescue
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/Column%20Level%20Masking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Column Level Masking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/Delta%20Live%20Tables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Delta Live Tables
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/User%20Defined%20Functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Defined Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced-notebooks/Working%20with%20JSON/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with JSON
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/leonsang/leonsang/edit/master/docs/spark-notebooks/notes.md" title="Editar esta página" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/leonsang/leonsang/raw/master/docs/spark-notebooks/notes.md" title="Ver código fuente de esta página" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


  <h1>Mis Notas</h1>

<h2 id="spark-concepts-and-code">Spark Concepts and Code<a class="headerlink" href="#spark-concepts-and-code" title="Permanent link">&para;</a></h2>
<h3 id="lecture-1-what-is-apache-spark">Lecture 1 : What is Apache Spark<a class="headerlink" href="#lecture-1-what-is-apache-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/ed862eae-aed7-4bd7-acfe-46fa117402bb" /></p>
<h4 id="unified">Unified :<a class="headerlink" href="#unified" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/8c33e885-bae7-4db0-983c-e84f1e5e0bfe" /></p>
<h4 id="computing-engine">Computing Engine:<a class="headerlink" href="#computing-engine" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/5d93b97e-c545-4885-8b7a-88b31d048197" /></p>
<p>Spark is not storage platform we can store the data in hdfs, rdbms etc...</p>
<p>Spark can process terabytes of data in distributed manner.</p>
<h4 id="compute-cluster">Compute Cluster:<a class="headerlink" href="#compute-cluster" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/1505275d-c247-435e-9db0-d1cfbb3cd9e9" /></p>
<ul>
<li>each slave has 16 GB RAM, 1TB storage and 4 core CPU</li>
<li>even master has some data and RAM</li>
<li>the above cluster can compute 64 gb of data at a time.</li>
<li>the master divides the data among the slave nodes and then slaves process the data.</li>
</ul>
<h3 id="lecture-2-why-apache-spark">Lecture 2 : Why Apache Spark?<a class="headerlink" href="#lecture-2-why-apache-spark" title="Permanent link">&para;</a></h3>
<p>Different Databases
<img alt="image" src="https://github.com/user-attachments/assets/9a0002db-8eae-46be-8a54-97836d7f17ae" /></p>
<p>new formats like video, audio, json,avro started coming in but rdms cannot handle it.</p>
<p>volume of data also increased. </p>
<h4 id="what-is-big-data">What is Big Data?<a class="headerlink" href="#what-is-big-data" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/392ce5ec-a93a-4f9d-afc8-2fec1ed9d920" /></p>
<p>Data Lake works on Extract Load Transform architecture</p>
<h4 id="issues-with-rdbms">Issues with RDBMS<a class="headerlink" href="#issues-with-rdbms" title="Permanent link">&para;</a></h4>
<ul>
<li>Storage</li>
<li>Processing - RAM and CPU</li>
</ul>
<p>Enter Spark...</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/0af03559-6cae-45e9-9d6c-322bfe032efd" /></p>
<h4 id="monolith-vs-microservice-architecture">Monolith vs Microservice Architecture<a class="headerlink" href="#monolith-vs-microservice-architecture" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/d3fb2d60-f182-4dbb-a8c6-e146e481a117" /></p>
<h3 id="lecture-3-hadoop-vs-spark">Lecture 3 : Hadoop vs Spark<a class="headerlink" href="#lecture-3-hadoop-vs-spark" title="Permanent link">&para;</a></h3>
<h4 id="misconception">Misconception:<a class="headerlink" href="#misconception" title="Permanent link">&para;</a></h4>
<ul>
<li>Hadoop is a database - its not a database just a filesystem (hdfs)</li>
<li>Spark is 100 times faster than hadoop</li>
<li>Spark processes data in RAM but Hadoop doesnt</li>
</ul>
<h4 id="differences">Differences<a class="headerlink" href="#differences" title="Permanent link">&para;</a></h4>
<h5 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/80625bf5-1712-44f6-a30d-47490e526e4d" /></p>
<p>Hadoop does lot of read write IO operations and sends data back and forth to the disk.
<img alt="image" src="https://github.com/user-attachments/assets/85eaa7f1-52b8-44a0-a283-4bd78e11b0a8" /></p>
<p>But in spark each executor has its own memory.
<img alt="image" src="https://github.com/user-attachments/assets/8c313769-001a-4a1c-a16a-a33ea125a92a" /></p>
<p>Where is there no difference?</p>
<p>When we have very less data like 10 GB, there is no difference because the hadoop cluster also doesnt write to the disk it fits first time in memory.</p>
<h5 id="batch-vs-stream-processing">Batch vs Stream Processing<a class="headerlink" href="#batch-vs-stream-processing" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/8f6b407c-d59c-457a-bbeb-09700b857b35" /></p>
<h5 id="ease-of-use">Ease of Use<a class="headerlink" href="#ease-of-use" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/35254ae3-78dc-417c-aab5-02b018e3e11f" /></p>
<p>Spark has both low level and high level API in Python which is easier than using Hive. Low level programming is on RDD level.</p>
<h5 id="security">Security<a class="headerlink" href="#security" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p>Hadoop has in built Kerberos Authentication via YARN whereas Spark doesnt have any security mechanism.</p>
</li>
<li>
<p>The authentication helps create ACL lists at directory level in HDFS.</p>
</li>
<li>
<p>Spark uses HDFS Storage so it gets ACL feature / ability and when it uses YARN it gets Kerberos Authentication.</p>
</li>
</ul>
<h5 id="fault-tolerance">Fault Tolerance<a class="headerlink" href="#fault-tolerance" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/6a4f988b-06b6-4860-a5c0-5302a2bb6ccb" /></p>
<p>Data Replication in Hadoop
<img alt="image" src="https://github.com/user-attachments/assets/2ef73e22-6288-44fb-8b2d-1ae974abbd95" /></p>
<p>HDFS keeps track of which node / rack has the data from A B C and D</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/26741f86-2eaf-4dce-b3d8-f2b9957bbeb4" /></p>
<p><strong>DAG in Spark</strong></p>
<ul>
<li>So Spark computes / transforms in multiple processes Process 1 -&gt; Process 2 -&gt; Process 3 ....</li>
<li>After each process the data is stored in a data structure called RDD which is immutable. So even if there is a failure Spark engine knows how to reconstruct the data for a particular process from the RDD at that stage.</li>
</ul>
<h3 id="lecture-4-spark-ecosystem">Lecture 4 : Spark Ecosystem<a class="headerlink" href="#lecture-4-spark-ecosystem" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/1790b682-10ba-4c47-8594-d743fbe54650" /></p>
<p>High Level API : We cna write any SQL queries in python,java etc... there are ML and GraphX librries also.</p>
<p>We can write code in many languages. Low Level API : we can make RDD's and work on them.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/452c4dc0-20d7-45e3-89f6-fb53719f75b9" /></p>
<h4 id="where-does-spark-run">Where does Spark run?<a class="headerlink" href="#where-does-spark-run" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/d2c11530-6dc3-485e-98c7-10e7bafac25b" /></p>
<p>Spark Engine would need some memory for transformation.</p>
<ul>
<li>suppose it needs 4 worker nodes each 20 GB and a driver node of 20 gb.</li>
<li>it goes to the cluster manager and asks for total 100 GB of memory, if available then the manager will assign that muuch storage.</li>
<li>cluster manager is also called YARN, K8S, Standalone managers</li>
</ul>
<h3 id="lecture-5-read-modes-in-spark">Lecture 5 : Read Modes in Spark<a class="headerlink" href="#lecture-5-read-modes-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/7ab22f33-3951-45d7-849e-83f693e5bf4b" /></p>
<p>format -&gt; data file format : csv,json,jdbc and odbc connection. Format is optional parameter, by default its parquet format
option -&gt; inferschema, mode and header [<strong>optional field</strong>]
schema -&gt; manual schema can be passed here
load -&gt; path from where we need to read the data [<strong>not optional</strong>]</p>
<h4 id="dataframereader-api">DataframeReader API<a class="headerlink" href="#dataframereader-api" title="Permanent link">&para;</a></h4>
<p>Access it using 'spark.read' in the spark session</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/0ba45b86-8921-41dc-8453-ebc4298184ab" /></p>
<h4 id="mode-in-spark"><code>mode</code> in Spark<a class="headerlink" href="#mode-in-spark" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/8ef66ae0-5f09-4610-8ae4-120aa9ecd673" /></p>
<h3 id="lecture-6-spark-architecture">Lecture 6 : Spark Architecture<a class="headerlink" href="#lecture-6-spark-architecture" title="Permanent link">&para;</a></h3>
<h4 id="spark-cluster">Spark Cluster<a class="headerlink" href="#spark-cluster" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/58ee64d9-0105-453c-97a6-9888b804c98a" /></p>
<ul>
<li>20 core per machine and 100 GB RAM / each machine</li>
<li>Total Cluster : 200 cores and 1TB RAM</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/aaaca550-af99-41ba-bbd3-158a83941819" /></p>
<ul>
<li>The master is controlled by Resource Manager and the workers are controlled by Node Manager.</li>
</ul>
<h4 id="what-happens-when-user-submits-code">What happens when user submits code?<a class="headerlink" href="#what-happens-when-user-submits-code" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/1cea605b-f750-406a-ae44-819bc06ccea3" /></p>
<ul>
<li>The user submits some Spark code for execution to the Resource Manager. It needs 20 GB RAM, 25 GB executor, 5 total executors and 5 CPU cores.</li>
<li>So the manager goes to W5 and asks to create 20GB container as the driver node.</li>
</ul>
<h4 id="what-happens-inside-the-container">What happens inside the container?<a class="headerlink" href="#what-happens-inside-the-container" title="Permanent link">&para;</a></h4>
<h5 id="driver-allocation">Driver Allocation<a class="headerlink" href="#driver-allocation" title="Permanent link">&para;</a></h5>
<p>Now this 20 GB driver is called Application Master
<img alt="image" src="https://github.com/user-attachments/assets/a85199e1-0036-4e51-842a-39faab13adab" /></p>
<p>There are two main() functions inside the master, one is for PySpark and other is for JVM like Java,Scala etc...</p>
<p>The JVM main() is called Application Driver.</p>
<p>The Spark Core has a Java Wrapper and the Java Wrapper has a Python Wrapper.</p>
<p>When we write code in PySpark it gets converted to Java Wrapper.</p>
<p>The PySpark driver is not a requirement but the Java Wrapper is required to run any code.</p>
<h5 id="worker-allocation">Worker Allocation<a class="headerlink" href="#worker-allocation" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/6fccdb87-a254-4bc2-9c50-38c9a9d26a02" /></p>
<ul>
<li>Now the Application master asks for the executors to be assigned and the resource manager allocates.</li>
</ul>
<h4 id="executor-container">Executor Container<a class="headerlink" href="#executor-container" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/1ee66178-03be-474c-8b02-ec1cc8f73a01" /></p>
<p>Each executor has 5 core CPU and 25GB RAM.</p>
<p>THe above is when we have pure Java code and dont use Python UDF.</p>
<p>But what if we use Python UDF functions?</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/69057cb6-f0f7-40c5-86ab-ab06689bcd08" />
We need a Python worker inside the executor to be able to run the code.</p>
<h3 id="lecture-7-schema-in-spark">Lecture 7 : Schema in Spark<a class="headerlink" href="#lecture-7-schema-in-spark" title="Permanent link">&para;</a></h3>
<h4 id="structtype-and-structfield">StructType and StructField<a class="headerlink" href="#structtype-and-structfield" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/c5adae79-16fa-4643-80ea-88c538407c9d" /></p>
<p>Example:</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/bb98a403-21d9-4721-9d48-442bc6bd5006" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/a042b2de-561a-4863-a85e-6bf589c385c3" /></p>
<p>How to skip the header row?</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;skipRows&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="s2">&quot;file.csv&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="lecture-8-handling-corrupter-records-in-spark">Lecture 8 : Handling Corrupter Records in Spark<a class="headerlink" href="#lecture-8-handling-corrupter-records-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/addd14cb-62fd-4af2-a770-8092879a5f1b" /></p>
<h4 id="how-many-records-in-each-mode">How many records in each mode?<a class="headerlink" href="#how-many-records-in-each-mode" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/a6396113-d14b-43a1-897d-a9f3eaedb022" /></p>
<h5 id="permissive-mode">Permissive Mode<a class="headerlink" href="#permissive-mode" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/83e72541-f3b8-4eaa-a08d-81087a9f21b9" /></p>
<h5 id="dropmalformed">DropMalformed<a class="headerlink" href="#dropmalformed" title="Permanent link">&para;</a></h5>
<p><img alt="image" src="https://github.com/user-attachments/assets/f20b5861-4bf1-4826-856d-2d6ae7680193" /></p>
<h4 id="how-to-print-corrupted-records">How to Print Corrupted Records<a class="headerlink" href="#how-to-print-corrupted-records" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/74bc5cd8-b0bb-4701-869d-ab6a19aa62d8" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/83aca551-1652-4fff-928b-bf0c22ef3d8d" /></p>
<p>Output
<img alt="image" src="https://github.com/user-attachments/assets/b8779e7e-5dcd-44fe-bfc1-4d218fe4177c" /></p>
<h4 id="how-to-store-corrupted-records">How to Store Corrupted Records<a class="headerlink" href="#how-to-store-corrupted-records" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/f9cbcb56-6f8d-47cb-8d3e-4c5427a0b27d" /></p>
<p>The corrupted records are in json format
<img alt="image" src="https://github.com/user-attachments/assets/51982d15-67d4-4f1a-94b8-ab51cc8e3bba" /></p>
<h3 id="lecture-9-transformations-and-actions-in-spark">Lecture 9 : Transformations and Actions in Spark<a class="headerlink" href="#lecture-9-transformations-and-actions-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/347c73e6-2cdb-491b-85b8-a98797df7b5f" /></p>
<h4 id="types-of-transformations">Types of Transformations<a class="headerlink" href="#types-of-transformations" title="Permanent link">&para;</a></h4>
<ul>
<li>Narrow Transformation</li>
<li>Wide Transformation</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/7fa407aa-fe59-4b90-a5f4-d1cb969e06e0" /></p>
<p>Example:
<img alt="image" src="https://github.com/user-attachments/assets/c7b44c1b-5e48-4728-9a24-93fe42762bf0" /></p>
<p>Suppose data is of 200MB. 200MB / 128MB = 2 partitions</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/0c74472a-ec82-4241-a236-2ed3c2e35ea2" /></p>
<p>Let's say both partitions go to separate executors.</p>
<p>Q1 : Filtering Records
<img alt="image" src="https://github.com/user-attachments/assets/5bbf61d7-1116-4d0d-b860-f5410f12c1b8" />
There is no data movement here.</p>
<p>Q2: Find Total Income of each employee
<img alt="image" src="https://github.com/user-attachments/assets/3524bd45-9d80-43d7-a134-2a43460fae5b" /></p>
<p>One id = 2 record is in one partition and the other is in the second partition so we need to do wide transformation
<img alt="image" src="https://github.com/user-attachments/assets/060eb0d1-a8fc-44b5-843e-738ebd87e42e" /></p>
<p>Data needs to be shuffled and records with same id must be moved to same partition.</p>
<ul>
<li>filter,select,union etc are narrow transformations</li>
<li>join,groupby,distinct</li>
</ul>
<h3 id="lecture-10-dag-and-lazy-evaluation-in-spark">Lecture 10 : DAG and Lazy Evaluation in Spark<a class="headerlink" href="#lecture-10-dag-and-lazy-evaluation-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/b323161d-5dcf-4a01-ad70-05b11c4e811f" /></p>
<ul>
<li>For every action there is a new job, here there are three actions : read,inferSchema,sum and show</li>
<li>When used with groupBy().sum(): It is considered an action because it triggers computation to aggregate data across partitions and produce a result. This operation forces Spark to execute the transformations leading up to it, effectively creating a job.</li>
<li>
<p>When used as a column expression df.select(sum("value")): It acts more like a transformation in Spark's context, especially if part of a larger query or pipeline that does not immediately trigger execution. In this case, it only defines the operation and does not create a job until an action (like show() or collect()) is called.</p>
</li>
<li>
<p>Job for reading file
<img alt="image" src="https://github.com/user-attachments/assets/c568a81e-dfa8-4637-bf22-637605286140" />
Whole Stage Codegen - generate Java ByteCode</p>
</li>
<li>
<p>Inferschema
<img alt="image" src="https://github.com/user-attachments/assets/c79751a7-ea04-444a-8940-61eb0d144a5f" /></p>
</li>
<li>
<p>GroupBy and Count
As explained above this is an action.</p>
</li>
<li>
<p>Show
Final action to display df</p>
</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/925397f9-c1e6-4662-ba01-a52d8bcc04ab" />
After we read the csv and inferSchema there are no jobs created since filter and repartition both are transformations not actions.</p>
<p>When there are two filters on same dataset</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/a05bb675-508b-42bb-8128-f38a5e0d21fa" /></p>
<p>This is the job
<img alt="image" src="https://github.com/user-attachments/assets/272cea9a-7570-4716-b831-1883472cc4be" /></p>
<h5 id="optimizations-on-the-filter">Optimizations on the Filter<a class="headerlink" href="#optimizations-on-the-filter" title="Permanent link">&para;</a></h5>
<p>Both the filters are on the same task
<img alt="image" src="https://github.com/user-attachments/assets/2682b8b3-3f31-4d5e-ba6a-b2ea32ea2246" />
The optimizations can be applied because Spark is lazily evaluated.</p>
<h3 id="lecture-11-working-with-json-data-in-spark">Lecture 11: Working with JSON Data in Spark<a class="headerlink" href="#lecture-11-working-with-json-data-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/09ce5719-db12-446c-8247-9495ea979768" /></p>
<p>Two types of JSON notation:</p>
<ul>
<li>
<p>Line Delimited JSON
<img alt="image" src="https://github.com/user-attachments/assets/95b248fd-491a-4083-963f-102489848154" /></p>
</li>
<li>
<p>Multi Line JSON
<img alt="image" src="https://github.com/user-attachments/assets/91f43e31-58a1-4443-a5c2-fc376ef61c38" /></p>
</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">{</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Manish&quot;</span><span class="p">,</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20000</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="p">},</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">{</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nikita&quot;</span><span class="p">,</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">21000</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="p">},</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="p">{</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pritam&quot;</span><span class="p">,</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">22000</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="p">},</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="p">{</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Prantosh&quot;</span><span class="p">,</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25000</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="p">},</span>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="p">{</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vikash&quot;</span><span class="p">,</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="p">,</span>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">40000</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="p">}</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="p">]</span>
</span></code></pre></div>
<p>Line Delimited JSON is more efficient in terms of performance because the compiler knows that each line has one JSON record whereas in multiline json the compiler needs to keept track of where the record ends and the next one starts.</p>
<h4 id="different-number-of-keys-in-each-line">Different number of keys in each line<a class="headerlink" href="#different-number-of-keys-in-each-line" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/8aeeeb0a-906f-44a5-b3a0-a7c5c8d28e31" /></p>
<p>Here what happens is that the line with the extra key has the value while for the rest its null
<img alt="image" src="https://github.com/user-attachments/assets/1fc8a438-c9f8-4d7e-8fbb-82c8ec73f167" /></p>
<h4 id="multiline-incorrect-json">Multiline Incorrect JSON<a class="headerlink" href="#multiline-incorrect-json" title="Permanent link">&para;</a></h4>
<p>We dont pass a list here rather its just dictionaries
<div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="p">{</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Manish&quot;</span><span class="p">,</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20000</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="p">},</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">{</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nikita&quot;</span><span class="p">,</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">21000</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="p">},</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="p">{</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pritam&quot;</span><span class="p">,</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="p">,</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">22000</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="p">},</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="p">{</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Prantosh&quot;</span><span class="p">,</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="p">,</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25000</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="p">},</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="p">{</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Vikash&quot;</span><span class="p">,</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="w">  </span><span class="nt">&quot;age&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="p">,</span>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="w">  </span><span class="nt">&quot;salary&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">40000</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="p">}</span>
</span></code></pre></div>
When we process the json it just reads the first dictionary as a record and the rest is not processed.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/6b25b6f2-8eda-466d-affc-08c0fed2f551" /></p>
<h4 id="corrupted-records">Corrupted Records<a class="headerlink" href="#corrupted-records" title="Permanent link">&para;</a></h4>
<p>We dont need to define <code>_corrupted_record</code> in the schema, it will add the column on its ownn</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/60f6c31e-6174-40ab-ba71-e3f0070a01fa" /></p>
<h3 id="lecture-12-spark-sql-engine">Lecture 12: Spark SQL Engine<a class="headerlink" href="#lecture-12-spark-sql-engine" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/ffb137d5-5a71-427d-b411-1493925ed6a4" /></p>
<h4 id="how-is-spark-code-compiled">How is Spark Code compiled?<a class="headerlink" href="#how-is-spark-code-compiled" title="Permanent link">&para;</a></h4>
<ul>
<li>The catalyst optimizer creates a plan and creates RDD lineage</li>
</ul>
<h4 id="phases-in-catalyst-optimizer">Phases in Catalyst Optimizer<a class="headerlink" href="#phases-in-catalyst-optimizer" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/4dcb1108-768c-4c28-aa21-732e93fda646" /></p>
<h5 id="workflow-diagram">Workflow Diagram<a class="headerlink" href="#workflow-diagram" title="Permanent link">&para;</a></h5>
<ul>
<li>Unresolved Logical Plan : Bunch of crude steps to execute the SQL code</li>
<li>Catalog : The table, files and database metadata information si stored in the catalog. Suppose we call read.csv on file that doesnt exist. The procedure that gives / throws the error is assisted via the catalog. In Analysis phase, we go through these steps. If some file/table is not found then we get <strong>Analysis Exception</strong> This error occurs when the Logical plan provided is not able to be resolved.</li>
<li>Reoslved Logical Plan : This is the phase when we finished analysing the catalog objects.</li>
<li>Logical Optimization: There are many examples. Suppose we need just two columns in select output, the spark engine does not fetch all the columns rather jsut fetches the two columns from memory that we need. Another example is when we use multiple filters on the same column in different lines of code. When we execute this code, we see that all of it is executed with <strong>or</strong> statements in one single line of code.</li>
<li>Physical Plan: This involves taking decision like the type of join to use: Broadcast Join is one example. From the logical plan, we can build multiple physical plans.
Thebest Physical Plan is a set of RDDs to be run on different executors on the cluster.</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/7931f705-5d53-45d0-8bdc-407e2b3426a7" /></p>
<h3 id="lecture-13-resilient-distributed-dataset">Lecture 13: Resilient Distributed Dataset<a class="headerlink" href="#lecture-13-resilient-distributed-dataset" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/9f092749-7050-4067-9b9f-4e19e3527a18" /></p>
<h4 id="data-storage-of-list">Data Storage of List<a class="headerlink" href="#data-storage-of-list" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/023e8304-b40a-40a6-8f61-516efe301635" /></p>
<h4 id="data-storage-in-rdd">Data Storage in RDD<a class="headerlink" href="#data-storage-in-rdd" title="Permanent link">&para;</a></h4>
<p>Suppose we have 500MB of data and 128MB partition, so we will have 4 partitions.</p>
<p>The data is scattered on various executors.
<img alt="image" src="https://github.com/user-attachments/assets/4c99e784-5366-4ee4-b1ac-c7baa0a49f34" /></p>
<p>Its not in single contiguous location like elements of a list. The data structure used ot process this data is called RDD
<img alt="image" src="https://github.com/user-attachments/assets/99aac217-5141-4c6b-bcbe-0873e7a9bbbd" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/01a10422-cb78-42a3-bb95-db643950b621" /></p>
<p>Why is RDD recoverable?</p>
<ul>
<li>
<p>RDD is immutable. If we apply multiple filters each dataset after filtering is a different dataset
<img alt="image" src="https://github.com/user-attachments/assets/ff872b52-f89f-406e-b8e1-30edd48624cf" /></p>
</li>
<li>
<p>In below case if rdd2 fails then we can restore rdd1 because of the lineage.
<img alt="image" src="https://github.com/user-attachments/assets/9497cf7a-7646-4dc1-ba2b-790e524572f5" /></p>
</li>
</ul>
<h4 id="disadvantage-of-rdd">Disadvantage of RDD<a class="headerlink" href="#disadvantage-of-rdd" title="Permanent link">&para;</a></h4>
<ul>
<li>No optimization done by Spark on RDD. The dev must specify explicitly on how to optimize RDD.</li>
</ul>
<h4 id="advantage">Advantage<a class="headerlink" href="#advantage" title="Permanent link">&para;</a></h4>
<ul>
<li>Works well with unstructured data where there are no columns and rows / key-value pairs</li>
<li>RDD is type safe, we get error on compile time rather than runtime which happens with Dataframe API.</li>
</ul>
<h4 id="avoiding-rdds">Avoiding RDDs<a class="headerlink" href="#avoiding-rdds" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/7dcd2caa-fac8-478f-9ba2-e99370c3fb44" /></p>
<ul>
<li>RDD : How to do? Dataframe API: Just specify what to do?</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/a028ab4e-b35e-4ead-9c04-a5cdbbf7f228" />
You can see in above case that we have a join and filter but we are specifically saying that first join then filter so it triggers a shuffle first and then filter which is not beneficial.</p>
<h3 id="lecture-14-parquet-file-internals">Lecture 14 : Parquet File Internals<a class="headerlink" href="#lecture-14-parquet-file-internals" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/50def6a3-7bfa-4b14-881d-46710762a06b" /></p>
<p>There are two types of file formats:</p>
<ul>
<li>Columnar Based and Row Based</li>
</ul>
<h4 id="physical-storage-of-data-on-disk">Physical Storage of Data on Disk<a class="headerlink" href="#physical-storage-of-data-on-disk" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/76e40279-29f0-43b3-80ec-fd4c3e9e4894" /></p>
<h4 id="write-once-read-many">Write Once Read Many<a class="headerlink" href="#write-once-read-many" title="Permanent link">&para;</a></h4>
<p>The funda of big data is write once read many.</p>
<ul>
<li>We dont need all the columns for analytics of big data, so columnar storage is the best.</li>
<li>If we store in row based format then we need to jump many memory racks to be able to get the data we need.</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/4fb9d3cc-541e-4b28-a818-5be35e211a8f" /></p>
<ul>
<li>OLTP generally use row base4d file format.</li>
<li>I/O should be reduced so OLAP uses columnar format.</li>
</ul>
<h4 id="why-columnar-format-may-not-be-the-best">Why Columnar format may not be the best?<a class="headerlink" href="#why-columnar-format-may-not-be-the-best" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/94d7beb7-be65-4836-9fce-1ec86285d842" /></p>
<p>In above case we can get col1 and col2 easily but for col10 we still need to scan the entire file.</p>
<p>To tackle this:</p>
<p>Let's say we have 100 million total rows.</p>
<p>We can store 100,000 records at a time, continuously in one row, then the next 100,000 records in next row and so on in hybrid format.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/af359956-aa81-4f62-a692-b1492bc7ae0c" /></p>
<h4 id="logical-partitioning-in-parquet">Logical Partitioning in Parquet<a class="headerlink" href="#logical-partitioning-in-parquet" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/d72060bc-6425-4b18-a1e8-3bd2e7b6376d" /></p>
<p>Let's day we have 500mb data, each row group by default has 128 mb data, so we will have 4 row groups.
Each row group will have some metadata attached to it.</p>
<p>In our example let's say one row group has 100000 records.
The column is futher stored as a page.</p>
<h4 id="runlength-encoding-and-bitpacking">Runlength Encoding and Bitpacking<a class="headerlink" href="#runlength-encoding-and-bitpacking" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/5a0219f3-ea0f-4758-ab80-1f3513a5a79f" /></p>
<p>Suppose we have 10 lakh records but there can be say 4 countries.</p>
<p>So parquet actually creates a dictionary of key value pair with key as int starting from 0 to 3 and then in the dictionary encoded data, we can see the keys being used insted of country name.</p>
<h4 id="demo">Demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h4>
<p><code>parquet-tools inspect &lt;filename&gt;</code></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/be572741-6fd9-470b-ad98-0f0d6c293a38" />
<img alt="image" src="https://github.com/user-attachments/assets/e4fff36d-48ed-4ca8-9cbd-310f8b35a103" /></p>
<p>Gives some file and brief column level metadata.</p>
<p><code>parquet_file.metadata.row_group(0).column_group(0)</code>
<img alt="image" src="https://github.com/user-attachments/assets/ea81d74c-6fb3-4c80-bbbf-521f6c1a3be2" /></p>
<p>Compression is GZIP
<img alt="image" src="https://github.com/user-attachments/assets/7d841a8d-fc8d-4f8c-8a42-da2b436a13fc" /></p>
<p>Encoding is explained on top.</p>
<h4 id="bitpacking-advantage">Bitpacking Advantage<a class="headerlink" href="#bitpacking-advantage" title="Permanent link">&para;</a></h4>
<ul>
<li>Bitpacking helps in compressing the bits so in above case we just have 4 unique values and hence we need just 2 bytes.</li>
<li>Query in seconds for running select on csv,parquet etc..</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/7700c5a0-90b9-4ad1-b430-25ca7df99903" /></p>
<h4 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/e4a1bbe6-629b-4970-94bf-a6493f32146b" /></p>
<ul>
<li>
<p>Here the actual data is stored in the pages and it has metadata like min,max and count.</p>
</li>
<li>
<p>Let's say we need to find out people less than 18 years age</p>
</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/eb37e1e1-ddab-42da-872b-0de10dbf12f2" /></p>
<p>Here when we divide data into row groups, we dont need to do any IO read operation on Row group 2, it saves lot of time and optimize performance.</p>
<p>The above concept is called <strong>Predicate Pushdown</strong>.</p>
<h4 id="projection-pruning">Projection Pruning<a class="headerlink" href="#projection-pruning" title="Permanent link">&para;</a></h4>
<p>Projection Pruning means we dont read IO from columns that are not part of the select query or that arent required for any join.</p>
<h3 id="lecture-15-how-to-write-data-on-the-disk">Lecture 15 : How to write data on the disk?<a class="headerlink" href="#lecture-15-how-to-write-data-on-the-disk" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/a22d1931-1b95-4515-9311-5c53883b47ba" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/03f8e132-9ead-4ae4-9d59-ad339ebcf615" /></p>
<h4 id="modes-to-write-data">Modes to write data<a class="headerlink" href="#modes-to-write-data" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/1ecedad1-043a-49d9-be96-d1ba66d062c3" /></p>
<p>Create three files
<img alt="image" src="https://github.com/user-attachments/assets/5e28b1b7-af47-4cb6-ac24-45d0a64b03a7" /></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>  <span class="n">write_df</span> <span class="o">=</span> <span class="n">read_df</span><span class="o">.</span><span class="n">repartition</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span>\
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;header&quot;</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">)</span>\
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    <span class="o">.</span><span class="n">mode</span><span class="p">(</span><span class="s2">&quot;overwrite&quot;</span><span class="p">)</span>\  <span class="c1"># Using .mode() instead of .option() for overwrite mode</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;/FileStore/tables/Write_Data/&quot;</span><span class="p">)</span>\
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="lecture-16-partitioning-and-bucketing">Lecture 16: Partitioning and Bucketing<a class="headerlink" href="#lecture-16-partitioning-and-bucketing" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/48c965e1-ffe3-4cb8-b1cf-40d3135a8cc1" /></p>
<p>In above data we cannot partition by any column because there is no similarity but we can bucket the data.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/a6557580-ea42-442b-9167-2bc4e5c825e0" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/637c53b2-5a96-4388-ab07-113e5917ce99" />
In above data we can partition by the country, but again we might have more data in India partition and less data in Japan.</p>
<h4 id="example-of-partitioning">Example of Partitioning<a class="headerlink" href="#example-of-partitioning" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/6fd554a4-5d68-41c5-bb7e-d2b59a5edd51" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/c9f1a402-de99-4ae2-8842-c357b31e3636" /></p>
<p>The advantage is that the entire data is not scanned and only few partitions are scanned based on the filters.</p>
<p><strong>Partitioning by Id</strong></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/ca71390e-bcd6-423e-9a0a-4a8f48abe967" /></p>
<p>Here we can see that we have created partitions by ID and since ID is low cardinality column partitioning is not efficient and we need to use bucketing.</p>
<h4 id="partitioning-by-address-and-gender">Partitioning by Address and Gender<a class="headerlink" href="#partitioning-by-address-and-gender" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/9a1a1836-f740-4f74-a3a8-412d8b4c39c6" /></p>
<h4 id="bucketing-by-id">Bucketing by Id<a class="headerlink" href="#bucketing-by-id" title="Permanent link">&para;</a></h4>
<p>Dividing into 3 buckets
<img alt="image" src="https://github.com/user-attachments/assets/9c9446d5-a67a-4a7b-9816-a3dd5f87a6f1" /></p>
<h4 id="tasks-vs-buckets">Tasks vs Buckets<a class="headerlink" href="#tasks-vs-buckets" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/28c545a4-74dd-4dc8-8406-f716a769b09b" /></p>
<ul>
<li>If we have 200 partitions we will have 200 tasks and each task will create 5 buckets each, to tackle this we first repartition into 5 partitions and then bucketBy 5.</li>
</ul>
<h4 id="how-does-bucketing-help-with-joins">How does bucketing help with joins?<a class="headerlink" href="#how-does-bucketing-help-with-joins" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/6db2b3d0-7a19-40dd-8f22-f0bb95b7df9e" /></p>
<ul>
<li>Here we can see that since we have same column bucket on both tables the ids can be easily mapped and there is no shuffling.</li>
</ul>
<h4 id="bucket-pruning">Bucket Pruning<a class="headerlink" href="#bucket-pruning" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/237d7bda-2c12-462c-9092-b71921c3321d" />
Suppose we have 1M Aadhar Ids and we divide into 100,000 each bucket so when we divide the above aadhar id by 100000 then we get the exact bucket where the number lies in.</p>
<h3 id="lecture-17-spark-session-vs-spark-context">Lecture 17 : Spark Session vs Spark Context<a class="headerlink" href="#lecture-17-spark-session-vs-spark-context" title="Permanent link">&para;</a></h3>
<ul>
<li>Spark Session is entry point to the Spark cluster where we provide the parameters to create and operate our cluster.</li>
<li>Spark session will have different context like one for SQL, PySpark etc...</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/c122f106-6b42-42d1-bd4a-201e8b482152" /></p>
<h3 id="lecture-18-job-stage-and-tasks">Lecture 18: Job, Stage and Tasks<a class="headerlink" href="#lecture-18-job-stage-and-tasks" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/f54725bf-2e81-4b73-a65c-97cb449887c7" /></p>
<ul>
<li>One Application is created.</li>
<li>One job is created per action.</li>
<li>One stage is defined for every transformation like filter.</li>
<li>Task is the actually activity on the data that's happening.</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/025a67b4-2ced-4ad9-a23a-eaa6d65f349c" /></p>
<h4 id="example-of-jobaction-and-task">Example of Job,Action and Task<a class="headerlink" href="#example-of-jobaction-and-task" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/b232dc8d-ff27-4650-92ca-7c3b912b5132" /></p>
<h4 id="complete-flow-diagram">Complete flow diagram<a class="headerlink" href="#complete-flow-diagram" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/4e07a77b-8885-46a7-8793-53d7dd3f5f59" /></p>
<p>Every job has minimum one stage and one task.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/96990346-8429-41e7-ac94-f11855baa9de" />
Repartition to filter is one job because we dont hit an action in between.</p>
<p>Every wide dependency transformation has its own stage. All narrow dependency transformations come in one stage as a DAG.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/d9c8d425-892c-4ac0-bb6e-930bc9f51a32" /></p>
<h4 id="how-do-tasks-get-created-read-and-write-exchange">How do tasks get created? [Read and Write Exchange]<a class="headerlink" href="#how-do-tasks-get-created-read-and-write-exchange" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/4d47470c-a3bc-4656-9b1a-7f718edd2c47" /></p>
<ul>
<li>The repartition stage actually is a wide dependency transformation and creates two partitions from one, its a Write exchange of data.</li>
<li>Now the filter and select stage reads this repartitioned data(<strong>Read exchange</strong>) and filter creates two tasks because we have two partitions.</li>
<li>Next we need to find out how many folks earn &gt; 90000 and age &gt; 25 so we need to do a groupby that's a wide dependency transformation and it creates another stage. By default there are 200 partitions created.</li>
<li>So some partitions may have data and some wont.</li>
</ul>
<p><img alt="image" src="https://github.com/user-attachments/assets/ec5734b2-3985-4fdd-abc4-4933e890e080" /></p>
<h3 id="lecture-17-dataframe-transformations-in-spark-part-1">Lecture 17: Dataframe Transformations in Spark Part 1<a class="headerlink" href="#lecture-17-dataframe-transformations-in-spark-part-1" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/b3c9d9a3-b664-4cde-868f-d8d9c508ed9f" />
Data gets stored in Row() format in the form of bytes</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/fccd78ab-d343-41dd-9a48-77122a4447d9" /></p>
<p>Columns are expressions. Expressions are set of transformations on more than one value in a record.</p>
<h4 id="ways-to-select-values-columns">Ways to select values / columns<a class="headerlink" href="#ways-to-select-values-columns" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/3bb9ee25-d1d2-42e9-bb8b-22cb7c1030d3" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/ccd538cb-5122-4ca4-ae8f-0e1d46a56996" /></p>
<p>Column Manipulations</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/be26f027-5ef2-4475-8fd9-2e520be44dab" /></p>
<p>Other methods
<img alt="image" src="https://github.com/user-attachments/assets/705819f1-fb56-4024-a3f1-4590706a58f7" /></p>
<p><strong>selectExpr</strong>
<img alt="image" src="https://github.com/user-attachments/assets/7ccf1d62-4834-43b8-84ae-7727a159eccc" /></p>
<p><strong>Aliasing Columns</strong>
<img alt="image" src="https://github.com/user-attachments/assets/e9710673-c2b4-476f-8296-fd1ee25681b5" /></p>
<h3 id="lecutre-18-dataframe-transformations-in-spark-part-ii">Lecutre 18 : Dataframe Transformations in Spark Part II<a class="headerlink" href="#lecutre-18-dataframe-transformations-in-spark-part-ii" title="Permanent link">&para;</a></h3>
<h4 id="filter-where-no-difference"><code>filter()</code> / <code>where()</code> no difference<a class="headerlink" href="#filter-where-no-difference" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/ccdb523c-04bb-490a-bd54-e051dc0d221b" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/19d178e5-086e-41c1-908f-689badb24df8" /></p>
<h4 id="multiple-filter-conditions">Multiple filter conditions<a class="headerlink" href="#multiple-filter-conditions" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/baa7134d-e151-404e-98d6-5dc8b010fc5d" /></p>
<h4 id="literals-in-spark">Literals in spark<a class="headerlink" href="#literals-in-spark" title="Permanent link">&para;</a></h4>
<p>Used to pass same value in all the columns
<img alt="image" src="https://github.com/user-attachments/assets/b96c60d9-754f-450d-bc46-7aaf6848c095" /></p>
<h4 id="adding-columns">Adding Columns<a class="headerlink" href="#adding-columns" title="Permanent link">&para;</a></h4>
<p>If the column already exists then it gets overwritten.
<img alt="image" src="https://github.com/user-attachments/assets/32f4d415-9685-4329-acfd-41ee7a7fd720" /></p>
<h4 id="renaming-columns">Renaming Columns<a class="headerlink" href="#renaming-columns" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/6fa9577a-c0f3-4e54-b756-d24cb6fb6eda" /></p>
<h3 id="lecture-19-union-vs-unionall">Lecture 19: union vs unionAll()<a class="headerlink" href="#lecture-19-union-vs-unionall" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/3e649ae8-6b69-4fa9-b687-109e4ede5615" /></p>
<p>We can see that here we have a duplicate id
<img alt="image" src="https://github.com/user-attachments/assets/3680c897-59c2-4f04-963d-3ce99981f3b4" /></p>
<p>In PySpark union and unionAll behaves in the same way, both retain duplicates
<img alt="image" src="https://github.com/user-attachments/assets/041e31d1-017f-45f7-aa7e-3c7db513d617" /></p>
<p>But in Spark SQL when we do union it drops the duplicate records
<img alt="image" src="https://github.com/user-attachments/assets/05af5b19-9963-4581-a71d-77fe42f739cf" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/00fde583-6538-4cc3-b275-97d8c5d620b2" /></p>
<h4 id="selecting-data-and-unioning-the-same-table">Selecting data and unioning the same table<a class="headerlink" href="#selecting-data-and-unioning-the-same-table" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/f9226608-4b77-40db-91e1-82072e8cd14b" /></p>
<h4 id="what-happens-when-we-change-the-order-of-the-columns">What happens when we change the order of the columns?<a class="headerlink" href="#what-happens-when-we-change-the-order-of-the-columns" title="Permanent link">&para;</a></h4>
<p><code>wrong_manager_df</code> actually has the wrong order of columns but still we get the union output but in a wrong column values.
<img alt="image" src="https://github.com/user-attachments/assets/3db3d2c8-3008-4930-b223-6f7bb31da477" /></p>
<p>If we give different number of columns an exception is thrown.
<img alt="image" src="https://github.com/user-attachments/assets/ece32bd0-6ea3-45f1-8919-721ef783c65b" /></p>
<p>If we use unionByName then the column names on both dfs must be the same.
<img alt="image" src="https://github.com/user-attachments/assets/fd3659ae-703f-42bc-bd4a-49c9c427cd9e" /></p>
<h3 id="lecture-19-repartitioning-and-coalesce">Lecture 19: Repartitioning and Coalesce<a class="headerlink" href="#lecture-19-repartitioning-and-coalesce" title="Permanent link">&para;</a></h3>
<p>Suppose we have 5 partitions and one of them is skewed a lot 100MB, let's say this is the best selling product records. This partition takes lot of time to compute. So the other executors have to wait until this executor finishes processing.
<img alt="image" src="https://github.com/user-attachments/assets/2a5567b0-486c-4b8b-aa91-41d077281e91" /></p>
<h4 id="repartitioning-vs-coalesce">Repartitioning vs Coalesce<a class="headerlink" href="#repartitioning-vs-coalesce" title="Permanent link">&para;</a></h4>
<h5 id="repartitioning">Repartitioning<a class="headerlink" href="#repartitioning" title="Permanent link">&para;</a></h5>
<p>Suppose we have the above partitions and total data is 100mb. let's say we do repartition(5) so we will have 5 partitions now for the data with 40mb per partition.</p>
<h5 id="coalesce">Coalesce<a class="headerlink" href="#coalesce" title="Permanent link">&para;</a></h5>
<p>In case of coalesce there is no equal splitting of partition memory, rather the already existing partitions get merged together.
<img alt="image" src="https://github.com/user-attachments/assets/85f6803b-6905-49e4-b3b3-3a896cde668f" /></p>
<p>There is no shuffling in coalesce but in repartitioning there is shuffling of data.</p>
<h4 id="pros-and-cons-in-repartitioning">Pros and Cons in repartitioning<a class="headerlink" href="#pros-and-cons-in-repartitioning" title="Permanent link">&para;</a></h4>
<ul>
<li>There is evenly distributed data.</li>
<li>Con is that IO operations are more, its expensive.</li>
<li>Con of coalesce is that the data is unevenly distributed.</li>
</ul>
<p>Repartitioning can increase or decrease the partitions but coalescing can only decrease the partitions.</p>
<h4 id="how-to-get-number-of-partitions">How to get number of partitions?<a class="headerlink" href="#how-to-get-number-of-partitions" title="Permanent link">&para;</a></h4>
<p><code>flight_df.rdd.getNumPartitions()</code> gets the initial number of partitions and then we can repartition <code>flight_df.repartition(4)</code>. Data is evenly distributed.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/00bd0cfe-e61a-4826-b978-b6c02924a363" /></p>
<p><strong>Repartitioning based on columns</strong></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/9d39f248-2be8-4520-a57a-4084bcfc297f" /></p>
<p>Since we asked for 300 partitions and we have 255 records some partitions will have null record.
<img alt="image" src="https://github.com/user-attachments/assets/c59615d8-65c1-44e8-85c4-3e1833a4cb60" /></p>
<h4 id="coalescing">Coalescing<a class="headerlink" href="#coalescing" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/210eb04d-80b3-4cce-a7dd-1b7757b3bd1c" />
Suppose we have 8 partitions and we coalesce into 3 partitions. Coalesce has only one arg.</p>
<p>Uneven distribution of data in partitions.
<img alt="image" src="https://github.com/user-attachments/assets/bc136007-2ae3-4df1-90b4-625352a81809" /></p>
<h3 id="lecture-20-case-when-if-else-in-spark">Lecture 20 : Case when / if else in Spark<a class="headerlink" href="#lecture-20-case-when-if-else-in-spark" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/ee17eab0-640d-4fc5-ac03-f751a8a90831" /></p>
<p><img alt="image" src="https://github.com/user-attachments/assets/310da700-3caa-44c2-a508-5fa19ff1ef66" /></p>
<h4 id="apply-logic-on-one-column-then-process-if-else-logic">Apply logic on one column then process if else logic<a class="headerlink" href="#apply-logic-on-one-column-then-process-if-else-logic" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/ba68a0f3-82d4-4db1-a879-fb977423f9dc" /></p>
<h4 id="spark-sql-logic">Spark SQL Logic<a class="headerlink" href="#spark-sql-logic" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/b0fd9a4f-b452-4132-9b6b-ad543a0c7056" /></p>
<h3 id="lecture-21-unique-and-sorted-records">Lecture 21 : Unique and Sorted Records<a class="headerlink" href="#lecture-21-unique-and-sorted-records" title="Permanent link">&para;</a></h3>
<p><img alt="image" src="https://github.com/user-attachments/assets/bff40f32-fa87-4a64-b448-a72ca92bf1d2" /></p>
<h4 id="distinct">distinct()<a class="headerlink" href="#distinct" title="Permanent link">&para;</a></h4>
<p>Original Data
<img alt="image" src="https://github.com/user-attachments/assets/8417fe25-264b-4d03-910b-a28063b07186" /></p>
<p>Distinct Data
<img alt="image" src="https://github.com/user-attachments/assets/95b4fe97-033f-4a28-87a7-d0a1ad37498b" /></p>
<p>Distinct Based on certain columns
<img alt="image" src="https://github.com/user-attachments/assets/612a6833-011e-4631-b706-4df9f318d6e9" /></p>
<p>⚠️ Distinct takes no arguments we need to select the columns first and then apply distinct.</p>
<h4 id="dropping-duplicate-records">Dropping duplicate records<a class="headerlink" href="#dropping-duplicate-records" title="Permanent link">&para;</a></h4>
<p>Point to note is that the dataframe <code>manager_df</code> has no changes, it just shows the records after dups have been dropped.
<img alt="image" src="https://github.com/user-attachments/assets/b443755e-1fc8-4d30-95f8-9c73c3412c6d" /></p>
<h4 id="sort">sort()<a class="headerlink" href="#sort" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/fc5d7b04-992a-4530-9660-a4f2ae7d82f9" /></p>
<p>Descending order
<img alt="image" src="https://github.com/user-attachments/assets/3865f2de-b818-4d5c-84e0-193390ba4586" /></p>
<p><strong>Sorting on multiple columns</strong></p>
<p>Here first the salary is srranged in desc order then we arrange the name in asc order from those records with same salary.
<img alt="image" src="https://github.com/user-attachments/assets/3fce7816-872f-414f-8bfb-8ad329d9ed73" /></p>
<h3 id="lecture-22-aggregate-functions">Lecture 22 : Aggregate functions<a class="headerlink" href="#lecture-22-aggregate-functions" title="Permanent link">&para;</a></h3>
<h4 id="count-as-both-action-and-transformation">Count as both Action and Transformation<a class="headerlink" href="#count-as-both-action-and-transformation" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/d2cd9647-fc8a-4247-b04e-539a48331f76" /></p>
<p>⚠️ When we are doing count on a single column and there is a null in it, its not considered in the count. But for all columns we have nulls in the count.
<img alt="image" src="https://github.com/user-attachments/assets/1ae8b278-3675-439c-9b12-8853064c9f3a" /></p>
<p>Job created in first case and its not created in second case below.
<img alt="image" src="https://github.com/user-attachments/assets/8a771986-85e2-465d-a2c4-d4a2bd86dfca" /></p>
<h3 id="lecture-23-group-by-in-spark">Lecture 23: Group By In Spark<a class="headerlink" href="#lecture-23-group-by-in-spark" title="Permanent link">&para;</a></h3>
<p>Sample Data</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/17c9a1dd-b003-4c67-8b1f-3f4e8fb6a556" /></p>
<h4 id="questions">Questions<a class="headerlink" href="#questions" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/60d2d30b-c2c9-4e3f-9544-b8ab7eece55c" /></p>
<p>Salary per department using groupBy()
<img alt="image" src="https://github.com/user-attachments/assets/b90a254d-1aac-46f1-8e2e-c66e8d99c0ad" /></p>
<h4 id="where-do-we-use-window-functions">Where do we use window functions?<a class="headerlink" href="#where-do-we-use-window-functions" title="Permanent link">&para;</a></h4>
<p>Suppose we need to find out the percentage of total salary from a particular dept that the person is earning. we can use window function to specify the total salary per department in the particular record itself like I've shown below.
<img alt="image" src="https://github.com/user-attachments/assets/6c328d14-bf1e-4059-83d5-618f6c7a0ec0" /></p>
<p>This way we dont need to perform a join.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/c6ababa6-3031-4147-887e-1b0b80a7fc13" /></p>
<h4 id="grouping-by-two-columns">Grouping by two columns<a class="headerlink" href="#grouping-by-two-columns" title="Permanent link">&para;</a></h4>
<p><img alt="image" src="https://github.com/user-attachments/assets/0822535b-c50a-433a-bd1e-67b9ee6b9dcc" /></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Volver al principio
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Pie" >
        
          
          <a href="../24_Skewness_And_Salting/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Skewness y Salting">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Anterior
              </span>
              <div class="md-ellipsis">
                Skewness y Salting
              </div>
            </div>
          </a>
        
        
          
          <a href="../../advanced-notebooks/Auto%20Loader%20%20Normal%20Schema%20Evolution/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Auto Loader Evolution">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Siguiente
              </span>
              <div class="md-ellipsis">
                Auto Loader Evolution
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/leonsang" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/erick-sang" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.footer", "navigation.instant", "navigation.instant.prefetch", "navigation.tracking", "toc.follow", "toc.integrate", "search.highlight", "search.suggest", "search.share", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.tooltips", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>